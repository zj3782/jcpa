/*C3*/SET SCHEMA PUBLIC
DELETE FROM PATTERN WHERE ID=10
INSERT INTO PATTERN VALUES(10,'ExpensiveOperationsInSynchronizedBlock','//ClassOrInterfaceBodyDeclaration\u000a[\u000adescendant::*/BlockStatement/Statement/SynchronizedStatement\u000a[\u000adescendant::*/BlockStatement/descendant::*/PrimaryExpression/PrimarySuffix[preceding-sibling::*[position()=1 and self::PrimaryPrefix]/Name[##AUX_EQ##]]/Arguments[@ArgumentCount>=0]\u000a]\u000a/Expression/PrimaryExpression/PrimaryPrefix/Name/@Image=\u000apreceding-sibling::*/FieldDeclaration[Type/ReferenceType/ClassOrInterfaceType[@Image="Map" or @Image="Set" or @Image="List"]/TypeArguments]/VariableDeclarator/VariableDeclaratorId/@Image\u000a]\u000a/MethodDeclaration/MethodDeclarator','There''re some expensive operations in synchronized block.','ExcessiveSynchronization','public class LoopExpensiveOperationsInSynchronizedBlock {\u000a     List<String> strList = new ArrayList<String>();\u000a     {\u000a \u000a         strList.add("A");\u000a         strList.add("B");\u000a         strList.add("C");\u000a     }\u000a     \u000a     public void excludeExpensiveOperation() {\u000a         synchronized (strList) {\u000a             strList.add("E");\u000a         }\u000a         costMethod();\u000a     }\u000a     \u000a     public void includeExpensiveOperation() {\u000a         synchronized (strList) {\u000a             strList.add("F");\u000a             costMethod();\u000a         }\u000a     }\u000a     \u000a     public void costMethod() {\u000a         \u000a     }\u000a}','inner-class',1,'costMethod,processItem')
COMMIT
/*C4*/SET SCHEMA PUBLIC
DELETE FROM PATTERN WHERE ID=13
INSERT INTO PATTERN VALUES(13,'CallCombinativeFunctionTwiceOrMore','//Statement[ForStatement]\u000a[\u000adescendant::*/Statement[descendant::*/BlockStatement/descendant::*/PrimaryExpression\u000a[PrimaryPrefix/Name[##AUX_EQ##]]\u000a/PrimarySuffix/Arguments[@ArgumentCount="1"]/ArgumentList/descendant::*/PrimaryPrefix/Name/@Image=\u000aancestor::*/ForStatement/LocalVariableDeclaration/VariableDeclarator/VariableDeclaratorId/@Image]\u000a]\u000a|\u000a//ClassOrInterfaceBodyDeclaration/descendant::*/BlockStatement\u000a[\u000adescendant::*/PrimaryExpression[PrimarySuffix/Arguments[@ArgumentCount>0]]/PrimaryPrefix/Name[##AUX_EQ##]/@Image=\u000apreceding-sibling::*/descendant::*/PrimaryExpression[PrimarySuffix/Arguments[@ArgumentCount>0]]/PrimaryPrefix/Name/@Image\u000a]\u000a[\u000adescendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal/@IntLiteral=\u000apreceding-sibling::*/descendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal/@IntLiteral\u000a]\u000a[\u000adescendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal/@FloatLiteral=\u000apreceding-sibling::*/descendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal/@FloatLiteral\u000a]\u000a[\u000adescendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal/@CharLiteral=\u000apreceding-sibling::*/descendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal/@CharLiteral\u000a]\u000a[\u000adescendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal/@StringLiteral=\u000apreceding-sibling::*/descendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal/@StringLiteral\u000a]\u000a[\u000adescendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal/@SingleCharacterStringLiteral=\u000apreceding-sibling::*/descendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal/@SingleCharacterStringLiteral\u000a]\u000a[not(\u000adescendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal/@Image=\u000apreceding-sibling::*/descendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal/@Image)\u000a]\u000a/descendant::*/PrimaryExpression[PrimarySuffix/Arguments[@ArgumentCount>0]]/PrimaryPrefix/Name[##AUX_EQ##]\u000a|\u000a//ClassOrInterfaceBodyDeclaration\u000a[\u000adescendant::*/BlockStatement/descendant::*/PrimaryExpression[PrimarySuffix/Arguments[@ArgumentCount>0]]/PrimaryPrefix/Name[##AUX_EQ##]/@Image=\u000apreceding-sibling::*/descendant::*/BlockStatement/descendant::*/PrimaryExpression[PrimarySuffix/Arguments[@ArgumentCount>0]]/PrimaryPrefix/Name/@Image\u000a]\u000a[not(\u000adescendant::*/BlockStatement/descendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal[not(@Image="")]/@Image=\u000apreceding-sibling::*/descendant::*/BlockStatement/descendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal[not(@Image="")]/@Image)\u000a]\u000a[\u000adescendant::*/BlockStatement/descendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal/@IntLiteral=\u000apreceding-sibling::*/descendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal/@IntLiteral\u000a]\u000a[\u000adescendant::*/BlockStatement/descendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal/@FloatLiteral=\u000apreceding-sibling::*/descendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal/@FloatLiteral\u000a]\u000a[\u000adescendant::*/BlockStatement/descendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal/@CharLiteral=\u000apreceding-sibling::*/descendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal/@CharLiteral\u000a]\u000a[\u000adescendant::*/BlockStatement/descendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal/@StringLiteral=\u000apreceding-sibling::*/descendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal/@StringLiteral\u000a]\u000a[\u000adescendant::*/BlockStatement/descendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal/@SingleCharacterStringLiteral=\u000apreceding-sibling::*/descendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal/@SingleCharacterStringLiteral\u000a]\u000a/descendant::*/BlockStatement/descendant::*/PrimaryExpression[PrimarySuffix/Arguments[@ArgumentCount>0]]/PrimaryPrefix/Name[##AUX_EQ##]\u000a|\u000a//ClassOrInterfaceBodyDeclaration\u000a[\u000adescendant::*/BlockStatement/descendant::*/PrimaryExpression[PrimarySuffix/Arguments[@ArgumentCount>=0]]/PrimaryPrefix/Name[##AUX_EQ##]/@Image=\u000apreceding-sibling::*/descendant::*/BlockStatement/descendant::*/PrimaryExpression[PrimarySuffix/Arguments[@ArgumentCount>=0]]/PrimaryPrefix/Name/@Image\u000a]\u000a[not(\u000adescendant::*/BlockStatement/descendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>=0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal[not(@Image="")]/@Image=\u000apreceding-sibling::*/descendant::*/BlockStatement/descendant::*/PrimaryExpression[PrimaryPrefix/Name]/PrimarySuffix/Arguments[@ArgumentCount>=0]\u000a/ArgumentList/Expression/PrimaryExpression/PrimaryPrefix/Literal[not(@Image="")]/@Image)\u000a]\u000a/descendant::*/BlockStatement/descendant::*/PrimaryExpression[PrimarySuffix/Arguments[@ArgumentCount>=0]]/PrimaryPrefix/Name[##AUX_EQ##]','It''ll call combinative function twice Or more times.','SuboptimalStatement','public class CallCombinativeFunctionTwiceOrMore {\u000a     public void correctCallMethods() {\u000a         cominativeMethod(new String[] { "A", "B" });\u000a     }\u000a \u000a     public void wrongCallMethods() {\u000a         cominativeMethod("A");\u000a         cominativeMethod("B");\u000a     }\u000a \u000a     void cominativeMethod(String s) {\u000a \u000a     }\u000a \u000a     void cominativeMethod(String[] s) {\u000a \u000a     }\u000a}','inner-class',1,'cominativeMethod,serviceA.call,processRow,Configuration.getInstance')
COMMIT
/*C3*/DELETE FROM PATTERN WHERE ID=5
INSERT INTO PATTERN VALUES(5,'CallSameFunctionTwiceOrMoreInClass','//MethodDeclaration/Block/BlockStatement\u000a/descendant::*/PrimaryExpression/PrimaryPrefix[following-sibling::*[position()=1 and self::PrimarySuffix]/Arguments[@ArgumentCount=0]]/Name\u000a[\u000a@Image=\u000apreceding::*\u000a/descendant::*/PrimaryExpression/PrimaryPrefix[following-sibling::*[position()=1 and self::PrimarySuffix]/Arguments[@ArgumentCount=0]]/Name/@Image\u000a]\u000a[not(##AUX_END##)]','You''d better not call the same function twice or more times in a class.','RedundantInvocation','public class CallSameFunctionTwiceOrMoreInClass {\u000a \u000a     MethodFactory mf = MethodFactory.getInstance();\u000a \u000a     String correctGetRed() {\u000a         return mf.getColor(true);\u000a     }\u000a \u000a     String correctGetGray() {\u000a         return mf.getColor(false);\u000a     }\u000a     \u000a     String wrongGetRed() {\u000a         return MethodFactory.getInstance().getColor(true);\u000a     }\u000a \u000a     String WrongGetGray() {\u000a         return MethodFactory.getInstance().getColor(false);\u000a     }\u000a \u000a \u000a}','inner-class',4,'.nextLine,.next,.hasNext,.size,.toString')
COMMIT
/*C6*/SET SCHEMA PUBLIC
DELETE FROM PATTERN WHERE ID=5
INSERT INTO PATTERN VALUES(5,'CallSameFunctionTwiceOrMoreInClass','//MethodDeclaration/Block/BlockStatement\u000a/descendant::*/PrimaryExpression/PrimaryPrefix[following-sibling::*[position()=1 and self::PrimarySuffix]/Arguments[@ArgumentCount=0]]/Name\u000a[\u000a@Image=\u000apreceding::*\u000a/descendant::*/PrimaryExpression/PrimaryPrefix[following-sibling::*[position()=1 and self::PrimarySuffix]/Arguments[@ArgumentCount=0]]/Name/@Image\u000a]\u000a[not(##AUX_END##)]','You''d better not call the same function twice or more times in a class.','RedundantInvocation','public class CallSameFunctionTwiceOrMoreInClass {\u000a \u000a     MethodFactory mf = MethodFactory.getInstance();\u000a \u000a     String correctGetRed() {\u000a         return mf.getColor(true);\u000a     }\u000a \u000a     String correctGetGray() {\u000a         return mf.getColor(false);\u000a     }\u000a     \u000a     String wrongGetRed() {\u000a         return MethodFactory.getInstance().getColor(true);\u000a     }\u000a \u000a     String WrongGetGray() {\u000a         return MethodFactory.getInstance().getColor(false);\u000a     }\u000a \u000a \u000a}','inner-class',4,'.nextLine,.next,.hasNext,.size,.toString,.lock,.unlock')
COMMIT
